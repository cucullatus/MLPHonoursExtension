<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>mlp.layers.Layer</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="mlp-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="mlp-module.html">Package&nbsp;mlp</a> ::
        <a href="mlp.layers-module.html">Module&nbsp;layers</a> ::
        Class&nbsp;Layer
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="mlp.layers.Layer-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class Layer</h1><p class="nomargin-top"><span class="codelink"><a href="mlp.layers-pysrc.html#Layer">source&nbsp;code</a></span></p>
<pre class="base-tree">
object --+
         |
        <strong class="uidshort">Layer</strong>
</pre>

<dl><dt>Known Subclasses:</dt>
<dd>
      <ul class="subclass-list">
<li><a href="mlp.layers.ComplexLinear-class.html">ComplexLinear</a></li><li>, <a href="mlp.layers.Linear-class.html">Linear</a></li><li>, <a href="mlp.convlin.ConvLinear_Opt-class.html">convlin.ConvLinear_Opt</a></li><li>, <a href="mlp.convlin.ConvMaxPool2D-class.html">convlin.ConvMaxPool2D</a></li>  </ul>
</dd></dl>

<hr />
<p>Abstract class defining an interface for other transforms.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="mlp.layers.Layer-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">rng</span>=<span class="summary-sig-default">None</span>)</span><br />
      x.__init__(...) initializes x; see help(type(x)) for signature</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.__init__">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="mlp.layers.Layer-class.html#bprop" class="summary-sig-name">bprop</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">h</span>,
        <span class="summary-sig-arg">igrads</span>)</span><br />
      Implements a backward propagation through the layer, that is, given...</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.bprop">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="mlp.layers.Layer-class.html#bprop_cost" class="summary-sig-name">bprop_cost</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">h</span>,
        <span class="summary-sig-arg">igrads</span>,
        <span class="summary-sig-arg">cost</span>=<span class="summary-sig-default">None</span>)</span><br />
      Implements a backward propagation in case the layer directly
deals with the optimised cost (i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.bprop_cost">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="mlp.layers.Layer-class.html#fprop" class="summary-sig-name">fprop</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">inputs</span>)</span><br />
      Implements a forward propagation through the i-th layer, that is
some form of:
   $a^{i} = xW^{i} + b^{i}$
   $h^{i} = f^{i}(a^{i})$
with f^{i}, W^{i}, b^{i} denoting a non-linearity, weight matrix and
biases at the i-th layer, respectively and x denoting inputs.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.fprop">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_name"></a><span class="summary-sig-name">get_name</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.get_name">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_params"></a><span class="summary-sig-name">get_params</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.get_params">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="pgrads"></a><span class="summary-sig-name">pgrads</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">inputs</span>,
        <span class="summary-sig-arg">deltas</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Return gradients w.r.t parameters</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.pgrads">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="set_params"></a><span class="summary-sig-name">set_params</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="mlp.layers-pysrc.html#Layer.set_params">source&nbsp;code</a></span>

          </td>
        </tr>
      </table>

    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">rng</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="mlp.layers-pysrc.html#Layer.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>

  <p>x.__init__(...) initializes x; see help(type(x)) for signature</p>
  <dl class="fields">
    <dt>Overrides:
        object.__init__
        <dd><em class="note">(inherited documentation)</em></dd>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="bprop"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">bprop</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">h</span>,
        <span class="sig-arg">igrads</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="mlp.layers-pysrc.html#Layer.bprop">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>

  <pre class="literalblock">

Implements a backward propagation through the layer, that is, given
$h^i$ denotes the output of the layer and $x^i$ the input, we compute:
$dh^i/dx^i$ which by chain rule is $dh^i/da^i da^i/dx^i$
$x^i$ could be either features $(x)$ or the output of the lower layer $h^{i-1}$
:param h: it's an activation produced in forward pass
:param igrads, error signal (or gradient) flowing to the layer, note,
       this in general case does not corresponds to 'deltas' used to update
       the layer's parameters, to get deltas ones need to multiply it with
       the $\partial h^{i}/ \partial a^{i}$ derivative
:return: a tuple (deltas, ograds) where:
       $deltas = igrads *  \partial h^{i}/ \partial a^{i}$
       $ograds = deltas         imes \partial a^{i}/ \partial x^{i}$

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="bprop_cost"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">bprop_cost</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">h</span>,
        <span class="sig-arg">igrads</span>,
        <span class="sig-arg">cost</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="mlp.layers-pysrc.html#Layer.bprop_cost">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>

  <pre class="literalblock">

Implements a backward propagation in case the layer directly
deals with the optimised cost (i.e. the top layer)
By default, method should implement a back-prop for default cost, that is
the one that is natural to the layer's output, i.e.:
linear -&gt; mse, softmax -&gt; cross-entropy, sigmoid -&gt; binary cross-entropy
:param $h$: it's an activation produced in forward pass
:param igrads, error signal (or gradient) flowing to the layer, note,
       this in general case does not corresponds to 'deltas' used to update
       the layer's parameters, to get deltas ones need to multiply it with
       the $\partial h^{i}/ \partial a^{i}$ derivative
:return: a tuple (deltas, ograds) where:
       $deltas = igrads * \partial h^{i}/ \partial a^{i}$
       $ograds = deltas         imes \partial a^{i}/ \partial x^{i}$

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="fprop"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">fprop</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">inputs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="mlp.layers-pysrc.html#Layer.fprop">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>

  <pre class="literalblock">

Implements a forward propagation through the i-th layer, that is
some form of:
   $a^{i} = xW^{i} + b^{i}$
   $h^{i} = f^{i}(a^{i})$
with f^{i}, W^{i}, b^{i} denoting a non-linearity, weight matrix and
biases at the i-th layer, respectively and x denoting inputs.

:param inputs: matrix of features $(x)$ or the output of the previous layer $h^{i-1}$
:return: $h^i$, matrix of transformed by layer features

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="mlp-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Mar 29 01:41:00 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
